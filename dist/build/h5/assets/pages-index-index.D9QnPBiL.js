import{g as e,_ as s,S as t,c as a,w as o,s as l,a as n,b as c,d as r,n as i,h as d,e as u,f as m,r as g,i as f,j as p,o as y,k as _,l as T,m as w,p as h,F as v,q as x,t as S,u as b}from"./index-CKATG7UM.js";const k=s({components:{Sidebar:t},data:()=>({systemStats:{totalDocuments:0,todayDocuments:0,successRate:0,averageProcessTime:0,systemPerformance:0,documentTypes:[]},isLoadingStats:!0,totalUsers:0,recentHistory:[]}),onShow(){console.log("ğŸ“± é¦–é¡µé‡æ–°æ˜¾ç¤ºï¼Œåˆ·æ–°æœ€è¿‘å†å²è®°å½•"),this.loadRecentHistory()},onLoad(){console.log("Index page loaded"),this.setupErrorHandling();const s=e("isLoggedIn"),t=e("token");if(console.log("ğŸ” é¡µé¢åŠ è½½æ£€æŸ¥:",{isLoggedIn:s,hasToken:!!t,tokenLength:t?t.length:0}),!s||!t)return console.log("âŒ æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ"),void g({url:"/pages/login/login"});console.log("âœ… ç”¨æˆ·å·²ç™»å½•ï¼Œå¼€å§‹è°ƒè¯•"),setTimeout(async()=>{!function(){const s=e("token"),t=e("isLoggedIn"),a=e("userInfo");if(console.group("ğŸ” è®¤è¯çŠ¶æ€è°ƒè¯•ä¿¡æ¯"),console.log("ç™»å½•çŠ¶æ€:",t),console.log("Tokenå­˜åœ¨:",!!s),console.log("Tokené•¿åº¦:",s?s.length:0),console.log("Tokenå‰20å­—ç¬¦:",s?s.substring(0,20)+"...":"null"),console.log("ç”¨æˆ·ä¿¡æ¯:",a),s)try{const e=s.split(".");if(3===e.length){const s=JSON.parse(atob(e[0])),t=JSON.parse(atob(e[1]));console.log("JWT Header:",s),console.log("JWT Payload:",t),console.log("JWTè¿‡æœŸæ—¶é—´:",t.exp?new Date(1e3*t.exp):"æœªè®¾ç½®"),console.log("å½“å‰æ—¶é—´:",new Date),console.log("Tokenæ˜¯å¦è¿‡æœŸ:",t.exp?1e3*t.exp<Date.now():"æ— æ³•åˆ¤æ–­")}}catch(o){console.log("Tokenä¸æ˜¯æ ‡å‡†JWTæ ¼å¼æˆ–è§£æå¤±è´¥")}console.groupEnd()}(),this.loadSystemStats(),this.loadRecentHistory()},300)},methods:{setupErrorHandling(){if("undefined"!=typeof window){const e=window.onunhandledrejection;window.onunhandledrejection=s=>s.reason&&"string"==typeof s.reason&&(s.reason.includes("Pro feature")||s.reason.includes("content_script")||s.reason.includes("extension")||s.reason.includes("chrome-extension")||s.reason.includes("moz-extension"))?(console.warn("ğŸ”§ æ£€æµ‹åˆ°æµè§ˆå™¨æ‰©å±•é”™è¯¯ï¼Œå·²å¿½ç•¥:",s.reason),void s.preventDefault()):s.reason&&s.reason.stack&&(s.reason.stack.includes("content_script")||s.reason.stack.includes("extension")||s.reason.stack.includes("chrome-extension")||s.reason.stack.includes("moz-extension"))?(console.warn("ğŸ”§ æ£€æµ‹åˆ°æ‰©å±•ç¨‹åºé”™è¯¯ï¼Œå·²å¿½ç•¥:",s.reason.message||s.reason),void s.preventDefault()):s.reason&&s.reason.message&&(s.reason.message.includes("ERR_EMPTY_RESPONSE")||s.reason.message.includes("ERR_CONNECTION_REFUSED")||s.reason.message.includes("request:fail")||s.reason.message.includes("Network Error"))?(console.warn("ğŸŒ æ£€æµ‹åˆ°ç½‘ç»œè¿æ¥é”™è¯¯ï¼Œå·²å¤„ç†:",s.reason.message),void s.preventDefault()):void(e&&e.call(window,s));const s=window.onerror;window.onerror=(e,t,a,o,l)=>t&&(t.includes("extension")||t.includes("content_script")||t.includes("chrome-extension")||t.includes("moz-extension"))?(console.warn("ğŸ”§ æ£€æµ‹åˆ°æ‰©å±•ç¨‹åºJSé”™è¯¯ï¼Œå·²å¿½ç•¥:",e),!0):"string"==typeof e&&(e.includes("ERR_EMPTY_RESPONSE")||e.includes("ERR_CONNECTION_REFUSED")||e.includes("request:fail")||e.includes("Network Error"))?(console.warn("ğŸŒ æ£€æµ‹åˆ°ç½‘ç»œé”™è¯¯ï¼Œå·²å¤„ç†:",e),!0):!!s&&s.call(window,e,t,a,o,l)}},async loadSystemStats(){var e;console.log("ğŸ“Š å¼€å§‹åŠ è½½ç³»ç»Ÿç»Ÿè®¡..."),this.isLoadingStats=!0;try{const s=await m();s&&s.overview?(console.log("âœ… æˆåŠŸè·å–ç³»ç»Ÿç»Ÿè®¡æ•°æ®:",s),this.systemStats={totalDocuments:s.overview.totalDocuments||0,todayDocuments:(null==(e=s.periodStats)?void 0:e.documentsUploaded)||0,successRate:Math.round(s.overview.successRate||0),averageProcessTime:s.overview.averageProcessingTime||0,systemPerformance:Math.round(s.overview.systemHealth||95),documentTypes:s.documentTypes||[]}):s&&void 0!==s.totalDocuments?(console.log("âœ… è·å–ç³»ç»Ÿç»Ÿè®¡æ•°æ®ï¼ˆæ—§æ ¼å¼ï¼‰:",s),this.systemStats={totalDocuments:s.totalDocuments||0,todayDocuments:s.todayDocuments||0,successRate:s.successRate||0,averageProcessTime:s.averageProcessTime||0,systemPerformance:s.systemPerformance||95,documentTypes:s.documentTypes||[]}):(console.log("ğŸ“Š APIæ— æœ‰æ•ˆæ•°æ®ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®"),this.useDefaultStats())}catch(s){s.message&&(s.message.includes("ERR_EMPTY_RESPONSE")||s.message.includes("ERR_CONNECTION_REFUSED")||s.message.includes("request:fail")||s.message.includes("Network Error")||s.message.includes("æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"))?console.info("ğŸ“Š åç«¯æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®å±•ç¤º"):console.warn("ğŸ“Š åŠ è½½ç³»ç»Ÿç»Ÿè®¡å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®:",s.message),this.useDefaultStats()}finally{this.isLoadingStats=!1}},async loadRecentHistory(){console.log("ğŸ“‹ å¼€å§‹åŠ è½½æœ€è¿‘å¤„ç†å†å²è®°å½•...");try{const e=await u({page:1,pageSize:5});e&&e.records&&e.records.length>0?(console.log("âœ… æˆåŠŸè·å–æœ€è¿‘å†å²è®°å½•:",e.records),this.recentHistory=e.records.map(e=>{var s,t,a,o,l;const n=e.extractedFields&&e.totalFields?Math.round(e.extractedFields/e.totalFields*100):0;return{id:e.id,taskId:(null==(t=null==(s=e.extractionTasks)?void 0:s[0])?void 0:t.id)||e.id,fileName:e.fileName||e.originalName||"æœªçŸ¥æ–‡æ¡£",processTime:this.formatProcessTime(e.processingTime||(null==(o=null==(a=e.extractionTasks)?void 0:a[0])?void 0:o.processingTime)),status:(null==(l=e.status)?void 0:l.toLowerCase())||"unknown",accuracy:n,documentType:e.documentType,createdAt:e.createdAt}}),console.log("âœ… è½¬æ¢åçš„å†å²è®°å½•:",this.recentHistory)):(console.log("ğŸ“‹ æš‚æ— å†å²è®°å½•"),this.recentHistory=[])}catch(e){console.warn("ğŸ“‹ åŠ è½½æœ€è¿‘å†å²è®°å½•å¤±è´¥:",e.message),this.recentHistory=[]}},formatProcessTime(e){if(!e)return"0s";if(e<60)return`${e}s`;{const s=Math.floor(e/60),t=e%60;return t>0?`${s}m ${t}s`:`${s}m`}},useDefaultStats(){this.systemStats={totalDocuments:0,todayDocuments:0,successRate:0,averageProcessTime:0,systemPerformance:0,documentTypes:[]},this.isLoadingStats=!1},navigateToUpload(){i({url:"/pages/upload/upload"})},navigateToResults(){i({url:"/pages/results/results"})},navigateToStatistics(){i({url:"/pages/statistics/statistics"})},navigateToHistory(){i({url:"/pages/history/history"})},async viewHistoryDetail(e){if("completed"===e.status)try{n({title:"åŠ è½½ç»“æœä¸­...",mask:!0}),console.log("ğŸ” é¦–é¡µç‚¹å‡»æŸ¥çœ‹å†å²è¯¦æƒ…ï¼Œè®°å½•ä¿¡æ¯:",e);const s=await c(e.id);if(!s)throw new Error("æ— æ³•è·å–æå–ç»“æœæ•°æ®");{console.log("ğŸ“¥ ä»APIè·å–çš„åŸå§‹ç»“æœ:",s);const t={id:s.id||e.taskId,taskId:s.taskId||e.taskId,documentId:s.documentId||e.id,status:s.status||"COMPLETED",progress:100,processingTime:s.processingTime||0,currentStep:"completed",extractedData:s.extractedData||{},extractionSummary:s.extractionSummary||{totalFields:this.getFixedTotalFieldsByType(e.documentType),extractedFields:e.accuracy?Math.round(e.accuracy*this.getFixedTotalFieldsByType(e.documentType)/100):0,documentType:e.documentType,processingTime:0,averageConfidence:.92,extractionRate:e.accuracy/100||0},qualityMetrics:s.qualityMetrics||{averageConfidence:.92,fieldCoverage:e.accuracy/100||0,processingTime:0},documentType:e.documentType,fileName:e.fileName,createdAt:s.createdAt||e.createdAt,completedAt:s.completedAt||e.createdAt};console.log("âœ… æ„å»ºå®Œæ•´ç»“æœæ•°æ®ï¼ˆä¸å¤„ç†å†å²é¡µé¢æ ¼å¼ä¸€è‡´ï¼‰:",t),r("currentExtractionResults",t),i({url:"/pages/results/results"})}}catch(s){console.error("âŒ åŠ è½½å†å²è¯¦æƒ…å¤±è´¥:",s),l({title:s.message||"åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}finally{d()}else l({title:"è¯¥æ–‡ä»¶å°šæœªå¤„ç†å®Œæˆï¼Œæ— æ³•æŸ¥çœ‹è¯¦æƒ…",icon:"none"})},getFixedTotalFieldsByType:e=>"fund_contract"===e?44:22,getStatusText:e=>({completed:"å¤„ç†å®Œæˆ",processing:"å¤„ç†ä¸­",failed:"å¤„ç†å¤±è´¥",pending:"ç­‰å¾…å¤„ç†",error:"å¤„ç†é”™è¯¯"}[e]||e)}},[["render",function(e,s,t,l,n,c){const r=p("Sidebar"),i=T,d=f;return y(),a(d,{class:"web-layout"},{default:o(()=>[_(r),_(d,{class:"web-content"},{default:o(()=>[_(d,{class:"content-wrapper"},{default:o(()=>[_(d,{class:"page-header fade-in-up"},{default:o(()=>[_(i,{class:"page-title"},{default:o(()=>[w("é¦–é¡µæ¦‚è§ˆ")]),_:1}),_(i,{class:"page-subtitle"},{default:o(()=>[w("æ¬¢è¿ä½¿ç”¨åŸºé‡‘å‘è¡Œå…¬å‘Šæå–ç³»ç»Ÿï¼Œæ™ºèƒ½åŒ–åŸºé‡‘æ–‡æ¡£ä¿¡æ¯æå–ä¸åˆ†æå¹³å°")]),_:1})]),_:1}),_(d,{class:"card-grid card-grid-3 fade-in-up"},{default:o(()=>[_(d,{class:"web-card card-primary",onClick:c.navigateToUpload},{default:o(()=>[_(d,{class:"card-header"},{default:o(()=>[_(i,{class:"card-title"},{default:o(()=>[w("æ–‡ä»¶ä¸Šä¼ ")]),_:1}),_(i,{class:"card-icon"},{default:o(()=>[w("ğŸ“¤")]),_:1})]),_:1}),_(d,{class:"card-content"},{default:o(()=>[_(i,{class:"card-text"},{default:o(()=>[w("ä¸Šä¼ åŸºé‡‘å‘è¡Œå…¬å‘ŠPDFæ–‡æ¡£")]),_:1}),_(d,{class:"web-button btn-accent",style:{"margin-top":"20rpx","margin-left":"180rpx"}},{default:o(()=>[_(i,null,{default:o(()=>[w("ç«‹å³ä¸Šä¼ ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onClick"]),_(d,{class:"web-card",onClick:c.navigateToResults},{default:o(()=>[_(d,{class:"card-header"},{default:o(()=>[_(i,{class:"card-title"},{default:o(()=>[w("æå–ç»“æœ")]),_:1}),_(i,{class:"card-icon"},{default:o(()=>[w("ğŸ“Š")]),_:1})]),_:1}),_(d,{class:"card-content"},{default:o(()=>[_(i,{class:"card-text"},{default:o(()=>[w("æŸ¥çœ‹æœ€æ–°çš„æ–‡æ¡£æå–ç»“æœå’Œåˆ†ææŠ¥å‘Š")]),_:1}),_(d,{class:"web-button btn-outline",style:{"margin-top":"20rpx","margin-left":"60rpx"}},{default:o(()=>[_(i,null,{default:o(()=>[w("æŸ¥çœ‹ç»“æœ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onClick"]),_(d,{class:"web-card",onClick:c.navigateToStatistics},{default:o(()=>[_(d,{class:"card-header"},{default:o(()=>[_(i,{class:"card-title"},{default:o(()=>[w("ç»Ÿè®¡åˆ†æ")]),_:1}),_(i,{class:"card-icon"},{default:o(()=>[w("ğŸ“ˆ")]),_:1})]),_:1}),_(d,{class:"card-content"},{default:o(()=>[_(i,{class:"card-text"},{default:o(()=>[w("æŸ¥çœ‹æ–‡æ¡£å¤„ç†ç»Ÿè®¡å’Œè¶‹åŠ¿åˆ†æ")]),_:1}),_(d,{class:"web-button btn-outline",style:{"margin-top":"20rpx","margin-left":"140rpx"}},{default:o(()=>[_(i,null,{default:o(()=>[w("æŸ¥çœ‹ç»Ÿè®¡")]),_:1})]),_:1})]),_:1})]),_:1},8,["onClick"])]),_:1}),_(d,{class:"web-card fade-in-up",style:{"margin-bottom":"60rpx"}},{default:o(()=>[_(d,{class:"card-header"},{default:o(()=>[_(i,{class:"card-title"},{default:o(()=>[w("æœ€è¿‘å¤„ç†è®°å½•")]),_:1}),_(d,{class:"web-button btn-outline",onClick:c.navigateToHistory},{default:o(()=>[_(i,null,{default:o(()=>[w("æŸ¥çœ‹å…¨éƒ¨")]),_:1})]),_:1},8,["onClick"])]),_:1}),_(d,{class:"card-content"},{default:o(()=>[_(d,{class:"web-table"},{default:o(()=>[_(d,{class:"table-header"},{default:o(()=>[_(d,{class:"table-row"},{default:o(()=>[_(i,{class:"table-cell"},{default:o(()=>[w("æ–‡æ¡£åç§°")]),_:1}),_(i,{class:"table-cell"},{default:o(()=>[w("å¤„ç†æ—¶é—´")]),_:1}),_(i,{class:"table-cell"},{default:o(()=>[w("çŠ¶æ€")]),_:1}),_(i,{class:"table-cell"},{default:o(()=>[w("å‡†ç¡®ç‡")]),_:1})]),_:1})]),_:1}),(y(!0),h(v,null,x(n.recentHistory,(e,s)=>(y(),a(d,{key:s,class:"table-row",onClick:s=>c.viewHistoryDetail(e)},{default:o(()=>[_(i,{class:"table-cell"},{default:o(()=>[w(S(e.fileName),1)]),_:2},1024),_(i,{class:"table-cell"},{default:o(()=>[w(S(e.processTime),1)]),_:2},1024),_(i,{class:b(["table-cell","status-"+e.status])},{default:o(()=>[w(S(c.getStatusText(e.status)),1)]),_:2},1032,["class"]),_(i,{class:"table-cell"},{default:o(()=>[w(S(e.accuracy)+"%",1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),_(d,{class:"card-grid card-grid-1 fade-in-up"},{default:o(()=>[_(d,{class:"web-card"},{default:o(()=>[_(d,{class:"card-header"},{default:o(()=>[_(i,{class:"card-title"},{default:o(()=>[w("å¤„ç†æ€§èƒ½")]),_:1}),_(i,{class:"card-icon"},{default:o(()=>[w("âš¡")]),_:1})]),_:1}),_(d,{class:"card-content"},{default:o(()=>[_(d,{class:"progress-bar"},{default:o(()=>[_(d,{class:"progress-fill",style:{width:"{{ systemStats.systemPerformance }}%"}})]),_:1}),_(i,{class:"card-text"},{default:o(()=>[w("ç³»ç»Ÿå¤„ç†æ•ˆç‡: "+S(n.systemStats.systemPerformance)+"%",1)]),_:1}),_(i,{class:"card-text"},{default:o(()=>[w("å¹³å‡å¤„ç†æ—¶é—´: "+S(n.systemStats.averageProcessTime)+"ç§’/æ–‡æ¡£",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-c867010f"]]);export{k as default};
