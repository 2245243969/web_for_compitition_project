import{_ as e,c as a,w as l,z as t,U as i,s,V as n,W as o,a as d,y as c,h as f,i as u,o as r,k as g,E as _,l as p,m,t as h,N as b,Z as y,G as k}from"./index-CKATG7UM.js";const C=e({name:"GlobalConfig",data:()=>({currentConfig:{has_global_config:!1,config:{}},config:{model_name:"",api_key:"",base_url:""},modelOptions:[{value:"deepseek-chat",label:"DeepSeek Chat",provider:"deepseek",defaultBaseUrl:"https://api.deepseek.com"},{value:"deepseek-reasoner",label:"DeepSeek Reasoner",provider:"deepseek",defaultBaseUrl:"https://api.deepseek.com"},{value:"kimi-k2-0905-preview",label:"Kimi K2 0905 Preview",provider:"kimi",defaultBaseUrl:"https://api.moonshot.cn/v1"},{value:"kimi-k2-turbo-preview",label:"Kimi K2 Turbo Preview",provider:"kimi",defaultBaseUrl:"https://api.moonshot.cn/v1"},{value:"ep-20241206172706-5hqf9",label:"豆包 智能文档分析模型",provider:"doubao",defaultBaseUrl:"https://ark.cn-beijing.volces.com/api/v3"},{value:"ep-20241127152712-ppt9z",label:"豆包 通用模型",provider:"doubao",defaultBaseUrl:"https://ark.cn-beijing.volces.com/api/v3"}],loading:!1,testing:!1,clearing:!1,modelIndex:0}),computed:{isFormValid(){return this.config.model_name&&this.config.api_key.trim()}},async onLoad(){await this.loadCurrentConfig()},methods:{async loadCurrentConfig(){try{"undefined"!=typeof uni&&d&&d({title:"加载配置中..."});const e=await c();this.currentConfig=e,e.has_global_config&&e.config&&(this.config.model_name=e.config.model_name||"",this.config.base_url=e.config.base_url||"",this.config.api_key="",this.updateModelIndex())}catch(e){console.error("加载配置失败:",e),this.currentConfig={has_global_config:!1,config:{}},"undefined"!=typeof uni&&s&&s({title:"加载配置失败："+(e.message||"未知错误"),icon:"none",duration:3e3})}finally{"undefined"!=typeof uni&&f&&f()}},updateModelIndex(){const e=this.modelOptions.findIndex(e=>e.value===this.config.model_name);this.modelIndex=e>=0?e:0},onModelChange(e){const a=e.detail.value;this.modelIndex=a;const l=this.modelOptions[a];this.config.model_name=l.value,this.config.base_url||(this.config.base_url=l.defaultBaseUrl)},getModelDisplayName(e){const a=this.modelOptions.find(a=>a.value===e);return a?a.label:e},async saveGlobalConfig(){if(this.isFormValid)try{this.loading=!0,await n(this.config),"undefined"!=typeof uni&&s&&s({title:"全局配置设置成功！",icon:"success",duration:2e3}),await this.loadCurrentConfig()}catch(e){console.error("保存配置失败:",e),"undefined"!=typeof uni&&s&&s({title:"保存失败："+(e.message||"未知错误"),icon:"none",duration:3e3})}finally{this.loading=!1}else"undefined"!=typeof uni&&s&&s({title:"请填写所有必填项",icon:"none"})},async testConnection(){if(this.isFormValid)try{this.testing=!0,await n(this.config);await o();"undefined"!=typeof uni&&s&&s({title:"连接测试成功！",icon:"success",duration:2e3}),await this.loadCurrentConfig()}catch(e){console.error("连接测试失败:",e),"undefined"!=typeof uni&&s&&s({title:"连接测试失败："+(e.message||"未知错误"),icon:"none",duration:3e3})}finally{this.testing=!1}else"undefined"!=typeof uni&&s&&s({title:"请先填写完整配置",icon:"none"})},async clearConfig(){try{if("undefined"!=typeof uni&&t){if(!(await new Promise(e=>{t({title:"确认清除",content:"确定要清除全局配置吗？清除后需要重新设置。",success:e})})).confirm)return}this.clearing=!0,await i(),"undefined"!=typeof uni&&s&&s({title:"配置已清除",icon:"success"}),this.config={model_name:"",api_key:"",base_url:""},this.modelIndex=0,await this.loadCurrentConfig()}catch(e){console.error("清除配置失败:",e),"undefined"!=typeof uni&&s&&s({title:"清除失败："+(e.message||"未知错误"),icon:"none",duration:3e3})}finally{this.clearing=!1}}}},[["render",function(e,t,i,s,n,o){const d=p,c=u,f=b,C=y,v=k;return r(),a(c,{class:"global-config-page"},{default:l(()=>[g(c,{class:"header"},{default:l(()=>[g(c,{class:"title"},{default:l(()=>[g(d,{class:"icon"},{default:l(()=>[m("⚙️")]),_:1}),g(d,{class:"text"},{default:l(()=>[m("全局模型配置")]),_:1})]),_:1}),g(c,{class:"subtitle"},{default:l(()=>[m("设置一次后，所有PDF处理都会默认使用此配置")]),_:1})]),_:1}),n.currentConfig.has_global_config?(r(),a(c,{key:0,class:"config-status"},{default:l(()=>[g(c,{class:"status-header"},{default:l(()=>[g(d,{class:"status-icon"},{default:l(()=>[m("✅")]),_:1}),g(d,{class:"status-text"},{default:l(()=>[m("当前已配置："+h(n.currentConfig.config.display_name),1)]),_:1})]),_:1}),g(c,{class:"config-info"},{default:l(()=>[g(c,{class:"config-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("模型名称：")]),_:1}),g(d,{class:"value"},{default:l(()=>[m(h(n.currentConfig.config.model_name),1)]),_:1})]),_:1}),g(c,{class:"config-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("服务提供商：")]),_:1}),g(d,{class:"value"},{default:l(()=>[m(h(n.currentConfig.config.provider),1)]),_:1})]),_:1}),n.currentConfig.config.base_url?(r(),a(c,{key:0,class:"config-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("API地址：")]),_:1}),g(d,{class:"value"},{default:l(()=>[m(h(n.currentConfig.config.base_url),1)]),_:1})]),_:1})):_("",!0),g(c,{class:"config-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("API密钥：")]),_:1}),g(d,{class:"value"},{default:l(()=>[m(h(n.currentConfig.config.has_api_key?"已配置":"未配置"),1)]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0),g(c,{class:"config-form"},{default:l(()=>[g(c,{class:"form-section"},{default:l(()=>[g(d,{class:"section-title"},{default:l(()=>[m("模型配置")]),_:1}),g(c,{class:"form-item model-select-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("模型名称 "),g(d,{class:"required"},{default:l(()=>[m("*")]),_:1})]),_:1}),g(f,{mode:"selector",value:n.modelIndex,range:n.modelOptions,"range-key":"label",onChange:o.onModelChange,class:"picker"},{default:l(()=>[g(c,{class:"picker-text"},{default:l(()=>[m(h(n.config.model_name?o.getModelDisplayName(n.config.model_name):"请选择模型")+" ",1),g(d,{class:"picker-arrow"},{default:l(()=>[m("▼")]),_:1})]),_:1})]),_:1},8,["value","range","onChange"])]),_:1}),g(c,{class:"form-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("API密钥 "),g(d,{class:"required"},{default:l(()=>[m("*")]),_:1})]),_:1}),g(C,{type:"text",modelValue:n.config.api_key,"onUpdate:modelValue":t[0]||(t[0]=e=>n.config.api_key=e),placeholder:"请输入API密钥",class:"api-input-fix"},null,8,["modelValue"])]),_:1}),g(c,{class:"form-item"},{default:l(()=>[g(d,{class:"label"},{default:l(()=>[m("API地址（可选）")]),_:1}),g(C,{type:"text",modelValue:n.config.base_url,"onUpdate:modelValue":t[1]||(t[1]=e=>n.config.base_url=e),placeholder:"留空使用默认地址",class:"api-input-fix"},null,8,["modelValue"]),g(d,{class:"help-text"},{default:l(()=>[m("留空将使用模型的默认API地址")]),_:1})]),_:1})]),_:1})]),_:1}),g(c,{class:"action-buttons"},{default:l(()=>[g(v,{class:"btn btn-primary",onClick:o.saveGlobalConfig,disabled:!o.isFormValid||n.loading},{default:l(()=>[n.loading?(r(),a(d,{key:0},{default:l(()=>[m("保存中...")]),_:1})):(r(),a(d,{key:1},{default:l(()=>[m("设置为全局默认")]),_:1}))]),_:1},8,["onClick","disabled"]),g(v,{class:"btn btn-secondary",onClick:o.testConnection,disabled:!o.isFormValid||n.testing},{default:l(()=>[n.testing?(r(),a(d,{key:0},{default:l(()=>[m("测试中...")]),_:1})):(r(),a(d,{key:1},{default:l(()=>[m("测试连接")]),_:1}))]),_:1},8,["onClick","disabled"]),n.currentConfig.has_global_config?(r(),a(v,{key:0,class:"btn btn-danger",onClick:o.clearConfig,disabled:n.clearing},{default:l(()=>[n.clearing?(r(),a(d,{key:0},{default:l(()=>[m("清除中...")]),_:1})):(r(),a(d,{key:1},{default:l(()=>[m("清除配置")]),_:1}))]),_:1},8,["onClick","disabled"])):_("",!0)]),_:1}),g(c,{class:"tips"},{default:l(()=>[g(c,{class:"tip-item"},{default:l(()=>[g(d,{class:"tip-icon"},{default:l(()=>[m("💡")]),_:1}),g(d,{class:"tip-text"},{default:l(()=>[m("设置全局配置后，所有PDF文档处理都将默认使用此配置")]),_:1})]),_:1}),g(c,{class:"tip-item"},{default:l(()=>[g(d,{class:"tip-icon"},{default:l(()=>[m("🔒")]),_:1}),g(d,{class:"tip-text"},{default:l(()=>[m("API密钥将安全存储在服务器端，不会在前端暴露")]),_:1})]),_:1}),g(c,{class:"tip-item"},{default:l(()=>[g(d,{class:"tip-icon"},{default:l(()=>[m("⚡")]),_:1}),g(d,{class:"tip-text"},{default:l(()=>[m("如果在特定操作中指定了其他模型，将优先使用指定的模型")]),_:1})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-56a7f20f"]]);export{C as default};
