# APIå‚æ•°å…¼å®¹æ€§é—®é¢˜ä¿®å¤æ€»ç»“

## ğŸš¨ é—®é¢˜åˆ†æ

### é”™è¯¯ä¿¡æ¯
```
âŒ æœ‰é—®é¢˜çš„è¯·æ±‚:
GET /api/documents/tasks/{id}/results?format=structured&includeMetadata=true

â†’ 404é”™è¯¯: Django REST Frameworkæ‰¾ä¸åˆ° "structured" æ ¼å¼çš„renderer

âœ… æ­£å¸¸çš„è¯·æ±‚:
GET /api/documents/tasks/{id}/results

â†’ 200æ­£å¸¸: åç«¯å¯ä»¥æ­£å¸¸å¤„ç†
```

### æ ¹æœ¬åŸå› 
**åç«¯ä¸æ”¯æŒ `format=structured` å’Œ `includeMetadata=true` å‚æ•°**ï¼

å‰ç«¯åœ¨å†å²è®°å½•é¡µé¢è°ƒç”¨APIæ—¶ä¼ å…¥äº†è¿™äº›å‚æ•°ï¼š
```javascript
const results = await getExtractionResultsApi(taskId, {
  format: 'structured',        // âŒ åç«¯ä¸æ”¯æŒ
  includeMetadata: true        // âŒ åç«¯ä¸æ”¯æŒ
})
```

ä½†åç«¯APIå®é™…ä¸Šåªæ”¯æŒæ— å‚æ•°è°ƒç”¨ï¼š
```javascript
const results = await getExtractionResultsApi(taskId)  // âœ… æ­£ç¡®
```

## ğŸ” é—®é¢˜å®šä½

### 1. è°ƒç”¨ä½ç½®
**æ–‡ä»¶**: `src/pages/history/history.vue`
**æ–¹æ³•**: `viewResults`
**è¡Œæ•°**: 430-433

### 2. é”™è¯¯çš„è°ƒç”¨æ–¹å¼
```javascript
// âŒ é”™è¯¯ï¼šä¼ å…¥äº†ä¸æ”¯æŒçš„å‚æ•°
const results = await getExtractionResultsApi(taskId, {
  format: 'structured',
  includeMetadata: true
})
```

### 3. å…¶ä»–è°ƒç”¨æƒ…å†µæ£€æŸ¥
- âœ… `src/pages/results/results.vue`: æ­£ç¡®è°ƒç”¨ï¼ˆæ— å‚æ•°ï¼‰
- âœ… `src/pages/upload/upload.vue`: ä»…å¯¼å…¥ï¼Œæœªç›´æ¥è°ƒç”¨
- âœ… APIå®šä¹‰æœ¬èº«æ”¯æŒå¯é€‰å‚æ•°ï¼Œä½†åç«¯å®é™…ä¸æ”¯æŒè¿™äº›ç‰¹å®šå€¼

## ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤å†…å®¹
**ä½ç½®**: `src/pages/history/history.vue` ç¬¬430è¡Œ

**ä¿®å¤å‰**:
```javascript
// ä½¿ç”¨æ ‡å‡†çš„æå–ç»“æœAPIï¼ˆå’Œä¸Šä¼ é¡µé¢å®Œæˆåä¸€æ ·ï¼‰
const results = await getExtractionResultsApi(taskId, {
  format: 'structured',
  includeMetadata: true
})
```

**ä¿®å¤å**:
```javascript
// ä½¿ç”¨æ ‡å‡†çš„æå–ç»“æœAPIï¼ˆä¸ä¼ å…¥ä¸æ”¯æŒçš„å‚æ•°ï¼‰
const results = await getExtractionResultsApi(taskId)
```

### ä¿®å¤é€»è¾‘
1. **ç§»é™¤ä¸æ”¯æŒçš„å‚æ•°**: ä¸å†ä¼ å…¥ `format` å’Œ `includeMetadata`
2. **ä¿æŒAPIè°ƒç”¨ç»Ÿä¸€**: ä¸å…¶ä»–é¡µé¢çš„è°ƒç”¨æ–¹å¼ä¿æŒä¸€è‡´
3. **ä¾èµ–åç«¯é»˜è®¤å¤„ç†**: è®©åç«¯è¿”å›é»˜è®¤æ ¼å¼çš„æ•°æ®

## ğŸ“Š APIè°ƒç”¨å¯¹æ¯”

### ä¿®å¤å‰ï¼ˆâŒ é”™è¯¯ï¼‰
```
GET /api/documents/tasks/b74428a8-f76b-4f55-acd8-e9d57b7ba858/results?format=structured&includeMetadata=true

HTTP 404 Not Found
Django REST Frameworkæ‰¾ä¸åˆ° "structured" æ ¼å¼çš„renderer
```

### ä¿®å¤åï¼ˆâœ… æ­£ç¡®ï¼‰
```
GET /api/documents/tasks/b74428a8-f76b-4f55-acd8-e9d57b7ba858/results

HTTP 200 OK
{
  "success": true,
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "result": {
      "id": "...",
      "taskId": "...",
      "extractedData": { ... }
    }
  }
}
```

## ğŸ¯ è§£å†³çš„é—®é¢˜

1. âœ… **APIè°ƒç”¨æˆåŠŸ**: ä¸å†å‡ºç°404é”™è¯¯
2. âœ… **æ•°æ®è·å–æ­£å¸¸**: åç«¯èƒ½æ­£å¸¸è¿”å›æå–ç»“æœ
3. âœ… **å†å²è®°å½•æŸ¥çœ‹åŠŸèƒ½æ¢å¤**: ç”¨æˆ·å¯ä»¥æ­£å¸¸æŸ¥çœ‹å†å²è®°å½•çš„ç»“æœ
4. âœ… **ä¿æŒåŠŸèƒ½ä¸€è‡´æ€§**: ä¸å…¶ä»–é¡µé¢çš„APIè°ƒç”¨æ–¹å¼ç»Ÿä¸€

## ğŸš€ æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤
1. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**
2. **è¿›å…¥å†å²è®°å½•é¡µé¢**
3. **ç‚¹å‡»"æŸ¥çœ‹ç»“æœ"æŒ‰é’®**
4. **æ£€æŸ¥æ§åˆ¶å°**ï¼šåº”è¯¥çœ‹åˆ°200æˆåŠŸå“åº”
5. **æ£€æŸ¥é¡µé¢æ˜¾ç¤º**ï¼šåº”è¯¥æ­£å¸¸æ˜¾ç¤ºç»“æ„åŒ–çš„å­—æ®µä¿¡æ¯

### é¢„æœŸç»“æœ
- âœ… **ç½‘ç»œè¯·æ±‚**: 200çŠ¶æ€ç ï¼Œæ— 404é”™è¯¯
- âœ… **æ§åˆ¶å°æ—¥å¿—**: `âœ… è·å–æå–ç»“æœæˆåŠŸ`
- âœ… **é¡µé¢æ˜¾ç¤º**: æ­£ç¡®çš„æ¨¡å—åŒ–å­—æ®µå±•ç¤º
- âœ… **ç”¨æˆ·ä½“éªŒ**: ä»å†å²è®°å½•å¯ä»¥æ­£å¸¸æŸ¥çœ‹ç»“æœ

## ğŸ“š ç»éªŒæ€»ç»“

### 1. APIå‚æ•°å…¼å®¹æ€§
- å‰ç«¯è°ƒç”¨APIæ—¶éœ€è¦ç¡®è®¤åç«¯æ”¯æŒçš„å‚æ•°
- ä¸è¦ç›²ç›®ä¼ å…¥æ–‡æ¡£ä¸­æåˆ°ä½†å®é™…ä¸æ”¯æŒçš„å‚æ•°
- ä¼˜å…ˆä½¿ç”¨æœ€ç®€å•ã€æœ€ç¨³å®šçš„APIè°ƒç”¨æ–¹å¼

### 2. é”™è¯¯è°ƒè¯•æ€è·¯
- 404é”™è¯¯é€šå¸¸æ˜¯è·¯å¾„æˆ–å‚æ•°é—®é¢˜
- æ£€æŸ¥APIè°ƒç”¨çš„URLå’Œå‚æ•°æ˜¯å¦æ­£ç¡®
- å¯¹æ¯”æˆåŠŸå’Œå¤±è´¥çš„è¯·æ±‚å·®å¼‚

### 3. ä»£ç ä¸€è‡´æ€§
- åŒä¸€ä¸ªAPIåœ¨ä¸åŒé¡µé¢çš„è°ƒç”¨æ–¹å¼åº”è¯¥ä¿æŒä¸€è‡´
- å¦‚æœæŸä¸ªé¡µé¢è°ƒç”¨æˆåŠŸï¼Œå…¶ä»–é¡µé¢åº”è¯¥é‡‡ç”¨ç›¸åŒæ–¹å¼

ç°åœ¨å†å²è®°å½•çš„"æŸ¥çœ‹ç»“æœ"åŠŸèƒ½åº”è¯¥èƒ½æ­£å¸¸å·¥ä½œäº†ï¼ğŸ‰


