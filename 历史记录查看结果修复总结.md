# å†å²è®°å½•æŸ¥çœ‹ç»“æœä¿®å¤æ€»ç»“

## ğŸ” é—®é¢˜åˆ†æ

### é—®é¢˜ç°è±¡
ç”¨æˆ·ç‚¹å‡»å†å²è®°å½•çš„"æŸ¥çœ‹ç»“æœ"æŒ‰é’®åå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š
- **404é”™è¯¯**: `GET /api/documents/history/{id}/results` - æ¥å£ä¸å­˜åœ¨
- **500é”™è¯¯**: `GET /api/documents/tasks/{id}/results` - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

### æ ¹æœ¬åŸå› 
**å†å²è®°å½•é¡µé¢ä½¿ç”¨äº†é”™è¯¯çš„APIæ¥å£**ï¼š
1. ä½¿ç”¨äº†ä¸å­˜åœ¨çš„ `getHistoryResultsApi` å‡½æ•°
2. è°ƒç”¨äº†ä¸å­˜åœ¨çš„ `HISTORY_RESULTS` APIè·¯ç”±
3. åº”è¯¥ä½¿ç”¨æ ‡å‡†çš„ `getExtractionResultsApi`ï¼Œä¸æ–‡ä»¶ä¸Šä¼ å®Œæˆåçš„é€»è¾‘ä¿æŒä¸€è‡´

## ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯
**è®©å†å²è®°å½•çš„"æŸ¥çœ‹ç»“æœ"ä¸æ–‡ä»¶ä¸Šä¼ å®Œæˆåçš„"æŸ¥çœ‹ç»“æœ"ä½¿ç”¨å®Œå…¨ç›¸åŒçš„é€»è¾‘**

### 1. ä¿®æ”¹APIå¯¼å…¥
**æ–‡ä»¶**: `src/pages/history/history.vue`

```javascript
// ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
import { getHistoryResultsApi } from '../../utils/api.js'

// ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
import { getExtractionResultsApi } from '../../utils/api.js'
```

### 2. é‡å†™ `viewResults` æ–¹æ³•
**æ ¸å¿ƒæ”¹åŠ¨**:

#### a) ç»Ÿä¸€ä½¿ç”¨æ ‡å‡†API
```javascript
// ä¿®æ”¹å‰ï¼ˆé”™è¯¯çš„APIï¼‰
const results = await getHistoryResultsApi(historyId)

// ä¿®æ”¹åï¼ˆæ ‡å‡†APIï¼‰
const results = await getExtractionResultsApi(taskId, {
  format: 'structured',
  includeMetadata: true
})
```

#### b) ç»Ÿä¸€ç»“æœæ•°æ®ç»“æ„
```javascript
// æ„å»ºä¸ä¸Šä¼ é¡µé¢å®Œå…¨ä¸€è‡´çš„ç»“æœç»“æ„
const completeResults = {
  id: taskId,
  taskId: taskId,
  status: 'COMPLETED',
  extractedData: results.extractedData || results,
  extractionSummary: results.extractionSummary || { /* å›é€€æ•°æ® */ },
  processingTime: record.processingTime || 0,
  documentType: record.documentType,
  fileName: record.fileName,
  createdAt: results.createdAt || record.createdAt,
  completedAt: results.completedAt || record.completedAt
}
```

#### c) ç»Ÿä¸€æ•°æ®ä¼ é€’æ–¹å¼
```javascript
// ä¸ä¸Šä¼ é¡µé¢å®Œå…¨ä¸€è‡´çš„å­˜å‚¨å’Œè·³è½¬æ–¹å¼
uni.setStorageSync('currentExtractionResults', completeResults)
uni.switchTab({
  url: '/pages/results/results'
})
```

### 3. æ¸…ç†æ— æ•ˆä»£ç 
**åˆ é™¤çš„å†…å®¹**:
- âŒ `src/utils/api.js` ä¸­çš„ `getHistoryResultsApi` å‡½æ•°
- âŒ `src/config/api-config.js` ä¸­çš„ `HISTORY_RESULTS` è·¯ç”±é…ç½®

## ğŸ“Š ä¿®å¤æ•ˆæœ

### âœ… é¢„æœŸç»“æœ
1. **ç»Ÿä¸€ä½“éªŒ**: å†å²è®°å½•å’Œä¸Šä¼ å®Œæˆåçš„"æŸ¥çœ‹ç»“æœ"è¡Œä¸ºå®Œå…¨ä¸€è‡´
2. **ä½¿ç”¨æ­£ç¡®API**: è°ƒç”¨ `/api/documents/tasks/{taskId}/results` æ¥å£
3. **æ•°æ®ç»“æ„ä¸€è‡´**: ç»“æœé¡µé¢æ¥æ”¶åˆ°çš„æ•°æ®æ ¼å¼å®Œå…¨ç›¸åŒ
4. **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶

### ğŸ”§ æŠ€æœ¯ç»†èŠ‚

#### TaskIDè·å–é€»è¾‘
```javascript
// ä¼˜å…ˆçº§é¡ºåº
1. record.extractionTasks[0].id  // æœ€å‡†ç¡®çš„ä»»åŠ¡ID
2. record.taskId                 // ç›´æ¥çš„ä»»åŠ¡IDå­—æ®µ
3. record.id                     // è®°å½•IDä½œä¸ºå›é€€
```

#### é”™è¯¯å¤„ç†ä¼˜åŒ–
- **ä¸»è¦æ–¹æ¡ˆ**: ä½¿ç”¨æ ‡å‡†APIè·å–å®Œæ•´ç»“æœ
- **å›é€€æ–¹æ¡ˆ**: é€šè¿‡ `currentTaskId` è®©ç»“æœé¡µé¢è‡ªè¡Œé‡æ–°åŠ è½½
- **ç”¨æˆ·æç¤º**: æ˜ç¡®çš„åŠ è½½çŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯

## ğŸ¯ ç”¨æˆ·ä½“éªŒæ”¹è¿›

### ä¿®å¤å‰ âŒ
- ç‚¹å‡»"æŸ¥çœ‹ç»“æœ" â†’ 404/500é”™è¯¯
- æ— æ³•æŸ¥çœ‹å†å²è®°å½•çš„æå–ç»“æœ
- é”™è¯¯ä¿¡æ¯ä¸æ˜ç¡®

### ä¿®å¤å âœ…
- ç‚¹å‡»"æŸ¥çœ‹ç»“æœ" â†’ æ­£å¸¸åŠ è½½å®Œæ•´çš„æå–ç»“æœ
- ä¸ä¸Šä¼ å®Œæˆåçš„ä½“éªŒå®Œå…¨ä¸€è‡´
- ç»Ÿä¸€çš„åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†

## ğŸš€ æµ‹è¯•å»ºè®®

### æµ‹è¯•æµç¨‹
1. **ä¸Šä¼ å¹¶æå–æ–‡æ¡£** â†’ å®Œæˆåç‚¹å‡»"æŸ¥çœ‹ç»“æœ" â†’ è®°å½•æ­£å¸¸ä½“éªŒ
2. **è¿›å…¥å†å²è®°å½•é¡µé¢** â†’ æ‰¾åˆ°è¯¥è®°å½• â†’ ç‚¹å‡»"æŸ¥çœ‹ç»“æœ"
3. **å¯¹æ¯”ä½“éªŒ** â†’ ä¸¤æ¬¡"æŸ¥çœ‹ç»“æœ"åº”è¯¥æ˜¾ç¤ºç›¸åŒçš„å†…å®¹å’Œå¸ƒå±€

### éªŒè¯è¦ç‚¹
- âœ… å†å²è®°å½•çš„"æŸ¥çœ‹ç»“æœ"èƒ½æ­£å¸¸è·³è½¬åˆ°ç»“æœé¡µé¢
- âœ… æ˜¾ç¤ºçš„æ•°æ®å†…å®¹ä¸ä¸Šä¼ å®Œæˆåä¸€è‡´
- âœ… å­—æ®µç»Ÿè®¡ã€å¤„ç†æ—¶é—´ç­‰ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
- âœ… å¯¼å‡ºåŠŸèƒ½æ­£å¸¸å·¥ä½œ

ç°åœ¨å†å²è®°å½•çš„"æŸ¥çœ‹ç»“æœ"åŠŸèƒ½å·²ç»ä¿®å¤ï¼Œä¸æ–‡ä»¶ä¸Šä¼ å®Œæˆåçš„ä½“éªŒå®Œå…¨ä¸€è‡´ï¼


